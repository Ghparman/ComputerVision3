<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Banana SSD Report</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    :root{
      --bg:#fafafa; --card:#ffffff; --muted:#6b7280; --accent:#0ea5a4;
      --pad:18px; --maxw:1100px;
    }
    html,body{height:100%; margin:0; font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;}
    body{background:var(--bg); color:#111; display:flex; justify-content:center; padding:28px;}
    .container{width:100%; max-width:var(--maxw);}
    header{display:flex; gap:16px; align-items:center; margin-bottom:18px;}
    header h1{margin:0; font-size:1.6rem;}
    header p{margin:0; color:var(--muted);}
    .card{background:var(--card); border-radius:10px; padding:var(--pad); box-shadow:0 6px 18px rgba(12,20,30,0.06); margin-bottom:18px;}
    .row{display:flex; gap:18px; align-items:flex-start; flex-wrap:wrap;}
    .col{flex:1 1 320px; min-width:280px;}
    .figure{background:#fff;border-radius:8px;padding:10px; text-align:center; border:1px solid #efefef;}
    .figure img{max-width:100%; border-radius:6px; cursor:pointer; display:block; margin:0 auto; height:auto;}
    .caption{font-size:0.95rem; color:var(--muted); margin-top:8px;}
    .figure h4{margin:6px 0 2px 0; font-size:1rem;}
    .section-title{display:flex; justify-content:space-between; align-items:center;}
    .notes{margin-top:10px; color:#222; line-height:1.45;}
    .samples-grid{display:grid; grid-template-columns: repeat(3, 1fr); gap:12px;}
    .sample-block{border-radius:8px; padding:10px; background:#fff; border:1px solid #efefef;}
    .meta{font-size:0.85rem; color:var(--muted);}
    /* lightbox */
    #lightbox{position:fixed; inset:0; background:rgba(0,0,0,0.75); display:none; align-items:center; justify-content:center; z-index:9999;}
    #lightbox img{max-width:94%; max-height:92%; border-radius:6px; box-shadow:0 10px 40px rgba(0,0,0,0.6);}
    #closeBtn{position:absolute; top:18px; right:18px; color:#fff; font-size:20px; cursor:pointer;}
    /* print-friendly */
    @media print {
      body{background:white}
      header, .card{box-shadow:none; border:none}
    }
    /* responsive */
    @media (max-width:720px){
      .samples-grid{grid-template-columns: 1fr;}
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1>Project 3</h1>
        <p>Overview of training curves, sample detections and Non-Maximum Suppression (NMS) behavior.</p>
      </div>
      <div style="margin-left:auto; text-align:right;">
        <small class="meta">Author: <strong>Greyson Parman</strong><br>Model: Simple SSD  — Custom NMS vs torchvision.ops.nms</small>
      </div>
    </header>

    <!-- Training Losses -->
    <section class="card" id="losses">
      <div class="section-title">
        <h2 style="margin:0">Training Losses</h2>
        <small class="meta">Epochs: 10</small>
      </div>
      <div class="row" style="margin-top:12px;">
        <div class="col figure">
          <h4>Classification Loss</h4>
          <img src="images/Loss.png" alt="classification loss" data-caption="Classification loss over epochs">
          <div class="caption">The Class loss performed very well with the Bounding Box having slight variations in loss. Overall they both fit very very well to the data. I do not believe this is overfitting, but it could be.</div>
        </div>
      </div>

    </section>

    <!-- Sample detections -->
    <section class="card" id="samples">
      <div class="section-title">
        <h2 style="margin:0">Sample Detections (5)</h2>
        <small class="meta">For each sample: raw detections, after custom NMS, after torchvision.ops.nms</small>
      </div>

<div style="margin-top:12px;">

  <!-- Sample 0 -->
  <div class="sample-block" style="margin-bottom:20px;">
    <h3 style="margin:6px 0;">Sample 0</h3>
    <div class="samples-grid">
      <div class="figure">
        <img src="images/Before_NMS_0.png" alt="Before NMS 0">
      </div>
      <div class="figure">
        <img src="images/AfterNMS0.png" alt="After NMS 0">
      </div>
    </div>
  </div>

  <!-- Sample 1 -->
  <div class="sample-block" style="margin-bottom:20px;">
    <h3 style="margin:6px 0;">Sample 1</h3>
    <div class="samples-grid">
      <div class="figure">
        <img src="images/Before_NMS_1.png" alt="Before NMS 1">
      </div>
      <div class="figure">
        <img src="images/AfterNMS1.png" alt="After NMS 1">
      </div>
    </div>
  </div>

  <!-- Sample 2 -->
  <div class="sample-block" style="margin-bottom:20px%;">
    <h3 style="margin:6px 0;">Sample 2</h3>
    <div class="samples-grid">
      <div class="figure">
        <img src="images/Before_NMS_2.png" alt="Before NMS 2">
      </div>
      <div class="figure">
        <img src="images/AfterNMS2.png" alt="After NMS 2">
      </div>
    </div>
  </div>

  <!-- Sample 3 -->
  <div class="sample-block" style="margin-bottom:20px;">
    <h3 style="margin:6px 0;">Sample 3</h3>
    <div class="samples-grid">
      <div class="figure">
        <img src="images/Before_NMS_3.png" alt="Before NMS 3">
      </div>
      <div class="figure">
        <img src="images/AfterNMS3.png" alt="After NMS 3">
      </div>
    </div>
  </div>

  <!-- Sample 4 -->
  <div class="sample-block" style="margin-bottom:20px;">
    <h3 style="margin:6px 0;">Sample 4</h3>
    <div class="samples-grid">
      <div class="figure">
        <img src="images/Before_NMS_4.png" alt="Before NMS 4">
      </div>
      <div class="figure">
        <img src="images/AfterNMS4.png" alt="After NMS 4">
      </div>
    </div>
  </div>

</div>


          <div style="margin-top:10px;">
            <strong>Discussion:</strong>
            <p class="notes">These test cases show that the bounding boxes were more than adequate before NMS as well as after. There appears to be an artifact in the top left corner of the "Before" images that I am not 100% sure where it is from.</p>
          </div>
        </div>

       
      </div>
    </section>

  <!-- Part 3 — Human–Object Interaction -->
<section class="card">
  <h2 style="margin:0 0 12px 0;">Part 3: Human–Object Interaction</h2>

  <!-- Preamble -->
  <p class="notes" style="margin-bottom:18px;">
    In this section I used GPT-5 to predict human object interactions. Before giving it any images it was prompted as follows, "I am going to upload 3 images for you. I want you to describe all of the human object interactions possible for the 3 images. Answer in the form of doublets that include <interaction>,<interaction object> for example if there is an apple you may say hold,apple and eat,apple"
    For each image below the caption is the returned HOI's from the model.  
  </p>

  <!-- HOI Example 1 -->
  <div class="figure" style="margin-bottom:24px;">
    <h3 style="margin:6px 0;">Example 1</h3>
    <img src="images/family.jpg" alt="HOI Example 1" style="max-width:100%; border-radius:8px;">
    
    <div class="caption" style="margin-top:8px; font-weight:600;">Model Output:</div>
    <pre class="notes" style="
      background:#f3f3f3; 
      padding:12px; 
      border-radius:8px; 
      overflow-x:auto;
    ">
Human–Object Interaction Doublets

Man in front (reaching toward cake):

reach, cake

touch, cake

cut (implied), cake

hold, birthday-cake utensil (if his hand is on one)

look, cake

look, table items

lean toward, cake table

Child on left (looking toward center):

look, cake

look, table items

look, small clown figurine

sit, chair (implied)

rest hands on, table

Middle child (blonde curls, in front):

look, cake

look, clown figurine

rest hands on, table

sit, chair (implied)

Child on right (smallest):

look, table items

look, cake

rest arms on, table

sit, chair (implied)

Teen older child in back:

look, cake

look, figurine

lean toward, table

General objects in scene being interacted with:

Cake

Table

Clown figurine

Framed picture on the table

Plates utensils (implied but not clearly touched)
    </pre>
  </div>

  <!-- HOI Example 2 -->
  <div class="figure" style="margin-bottom:24px;">
    <h3 style="margin:6px 0;">Example 2</h3>
    <img src="images/horse.jpg" alt="HOI Example 2" style="max-width:100%; border-radius:8px;">
    
    <div class="caption" style="margin-top:8px; font-weight:600;">Model Output:</div>
    <pre class="notes" style="
      background:#f3f3f3;
      padding:12px; 
      border-radius:8px; 
      overflow-x:auto;
    ">
Human–Object Interaction Doublets (Image 2)

Rider:

ride, horse

sit on, horse

hold, reins

pull, reins (slight tension visible)

wear, hat

wear, boots

wear, vest

wear, jeans

look, road ahead

control, horse

balance on, saddle

rest feet in, stirrups

Horse (as an object for interactions):

lead, horse

guide, horse

Environment interactions (human → objects):

move through, underpass bridge

travel on, road
    </pre>
  </div>

  <!-- HOI Example 3 -->
  <div class="figure" style="margin-bottom:24px;">
    <h3 style="margin:6px 0;">Example 3</h3>
    <img src="images/baby.jpg" alt="HOI Example 3" style="max-width:100%; border-radius:8px;">
    
    <div class="caption" style="margin-top:8px; font-weight:600;">Model Output:</div>
    <pre class="notes" style="
      background:#f3f3f3; 
      padding:12px; 
      border-radius:8px; 
      overflow-x:auto;
    ">
Human–Object Interaction Doublets (Image 3)

Baby:

hold, bottle

grip, bottle

drink from, bottle

touch, bottle nipple

lean toward, bottle

rest hand on, bottle

wear, clothing

Adult hand (feeding the baby):

hold, bottle

support, bottle

guide, bottle

Bottle (object):

press, bottle nipple (by mouth)

tilt, bottle (by adult hand and baby position)
    </pre>
  </div>

</section>
<section class="card">
  <h2 style="margin:0 0 8px 0">Closing Thoughts</h2>
  <p class="notes">
    The model is incredibly good at finding the HOI's in these images. while they are not super hard, the family image shows a robustness from the model that surprised me. These are just the most interesting 3 to me, but I tried other images and could not get a real "failure" case.
  </p>
</section>
  <!-- lightbox -->
  <div id="lightbox" onclick="hideLightbox()">
    <span id="closeBtn" onclick="hideLightbox()">✕</span>
    <img id="lightbox-img" src="">
  </div>

  <script>
    // click-to-enlarge for images
    document.querySelectorAll('.figure img').forEach(img=>{
      img.addEventListener('click', (e)=>{
        e.stopPropagation();
        const src = img.getAttribute('src');
        document.getElementById('lightbox-img').src = src;
        document.getElementById('lightbox').style.display = 'flex';
      });
    });
    function hideLightbox(){
      document.getElementById('lightbox').style.display = 'none';
    }
    // prevent click propagation on the lightbox image
    document.getElementById('lightbox-img').addEventListener('click', (e)=>e.stopPropagation());
  </script>
</body>
</html>
